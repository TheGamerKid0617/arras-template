const protocol=function(){let b=new Uint32Array(1),g=new Uint8Array(b.buffer),k=new Float32Array(b.buffer),d=new Uint16Array(1),w=new Uint8Array(d.buffer);return{encode:t=>{let a=[],r=[],s=0,n=15,h=0;for(var l of t){let e=0;if(0===l||!1===l)e=0;else if(1===l||!0===l)e=1;else if("number"==typeof l)!Number.isInteger(l)||l<-4294967296||4294967296<=l?(e=8,s+=4):0<=l?l<256?(e=2,s++):l<65536?(e=4,s+=2):l<4294967296&&(e=6,s+=4):-256<=l?(e=3,s++):-65536<=l?(e=5,s+=2):-4294967296<=l&&(e=7,s+=4);else{if("string"!=typeof l)throw console.error("Unencodable data type",l),new Error("Unencodable data type");{let r=!1;for(let e=0;e<l.length;e++)if("Ã¿"<l.charAt(e))r=!0;else if("\0"===l.charAt(e))throw console.error("Null containing string",l),new Error("Null containing string");!r&&l.length<=1?(e=9,s++):r?(e=11,s+=2*l.length+2):(e=10,s+=l.length+1)}}if(a.push(e),e===n)h++;else{if(r.push(n),1<=h){for(;19<h;)r.push(14),r.push(15),h-=19;1===h?r.push(n):2===h?r.push(12):3===h?r.push(13):h<20&&(r.push(14),r.push(h-4))}h=0,n=e}}if(r.push(n),1<=h){for(;19<h;)r.push(14),r.push(15),h-=19;1===h?r.push(n):2===h?r.push(12):3===h?r.push(13):h<20&&(r.push(14),r.push(h-4))}r.push(15),r.length%2==1&&r.push(15);let o=new Uint8Array((r.length>>1)+s);for(let e=0;e<r.length;e+=2){var u=r[e],c=r[e+1];o[e>>1]=u<<4|c}let f=r.length>>1;for(let e=0;e<a.length;e++){let r=t[e];switch(a[e]){case 0:case 1:break;case 2:case 3:o[f++]=r;break;case 4:case 5:d[0]=r,o.set(w,f),f+=2;break;case 6:case 7:b[0]=r,o.set(g,f),f+=4;break;case 8:k[0]=r,o.set(g,f),f+=4;break;case 9:var p=0===r.length?0:r.charCodeAt(0);o[f++]=p;break;case 10:for(let e=0;e<r.length;e++)o[f++]=r.charCodeAt(e);o[f++]=0;break;case 11:for(let e=0;e<r.length;e++){var i=r.charCodeAt(e);o[f++]=255&i,o[f++]=i>>8}o[f++]=0,o[f++]=0}}return o},decode:e=>{var r,t=new Uint8Array(e);if(t[0]>>4!=15)return null;let a=[],s=15,n=0,h=!0;for(;;){if(n>=t.length)return null;let e=t[n];if(h?(e&=15,n++):e>>=4,h=!h,12==(12&e)){if(15===e){h&&n++;break}let r=e-10;if(14===e){if(n>=t.length)return null;let e=t[n];h?(e&=15,n++):e>>=4,h=!h,r+=e}for(let e=0;e<r;e++)a.push(s)}else a.push(e),s=e}let l=[];for(r of a)switch(r){case 0:l.push(0);break;case 1:l.push(1);break;case 2:l.push(t[n++]);break;case 3:l.push(t[n++]-256);break;case 4:w[0]=t[n++],w[1]=t[n++],l.push(d[0]);break;case 5:w[0]=t[n++],w[1]=t[n++],l.push(d[0]-65536);break;case 6:g[0]=t[n++],g[1]=t[n++],g[2]=t[n++],g[3]=t[n++],l.push(b[0]);break;case 7:g[0]=t[n++],g[1]=t[n++],g[2]=t[n++],g[3]=t[n++],l.push(b[0]-4294967296);break;case 8:g[0]=t[n++],g[1]=t[n++],g[2]=t[n++],g[3]=t[n++],l.push(k[0]);break;case 9:var o=t[n++];l.push(0===o?"":String.fromCharCode(o));break;case 10:{let e="";for(var u;u=t[n++];)e+=String.fromCharCode(u);l.push(e)}break;case 11:{let e="";for(var c;c=t[n++]|t[n++]<<8;)e+=String.fromCharCode(c);l.push(e)}}return l}}}();export{protocol};