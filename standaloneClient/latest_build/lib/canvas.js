import{global}from"./global.js";class Canvas{constructor(e){this.directionLock=!1,this.target=global.target,this.reenviar=!0,this.socket=global.socket,this.directions=[];this.cv=document.getElementById("gameCanvas"),this.cv.width=innerWidth,this.cv.height=innerHeight,this.cv.addEventListener("mousemove",this.gameInput,!1),this.cv.addEventListener("keydown",this.keyboardDown,!1),this.cv.addEventListener("keyup",this.keyboardUp,!1),this.cv.addEventListener("mousedown",this.mouseDown,!1),this.cv.addEventListener("mouseup",this.mouseUp,!1),this.cv.parent=this,global.canvas=this}keyboardDown(a){switch(a.keyCode){case 13:global.died&&this.parent.socket.talk("s",global.playerName,0),global.died=!1;break;case global.KEY_UP_ARROW:if(!global.died&&global.showTree)return global.realScrollX=0;case global.KEY_UP:this.parent.socket.cmd.set(0,!0);break;case global.KEY_DOWN_ARROW:if(!global.died&&global.showTree)return global.realScrollX=1;case global.KEY_DOWN:this.parent.socket.cmd.set(1,!0);break;case global.KEY_LEFT_ARROW:if(!global.died&&global.showTree)return global.realScrollX-=global.realScrollX<=0?0:.01;case global.KEY_LEFT:this.parent.socket.cmd.set(2,!0);break;case global.KEY_RIGHT_ARROW:if(!global.died&&global.showTree)return global.realScrollX+=1<=global.realScrollX?0:.01;case global.KEY_RIGHT:this.parent.socket.cmd.set(3,!0);break;case global.KEY_MOUSE_0:this.parent.socket.cmd.set(4,!0);break;case global.KEY_MOUSE_1:this.parent.socket.cmd.set(5,!0);break;case global.KEY_MOUSE_2:this.parent.socket.cmd.set(6,!0);break;case global.KEY_LEVEL_UP:this.parent.socket.talk("L");break;case global.KEY_FUCK_YOU:this.parent.socket.talk("0");break;case global.KEY_MAX_STAT:global.statMaxing=!0}if(!a.repeat){switch(a.keyCode){case global.KEY_AUTO_SPIN:this.parent.socket.talk("t",0);break;case global.KEY_AUTO_FIRE:this.parent.socket.talk("t",1);break;case global.KEY_OVER_RIDE:this.parent.socket.talk("t",2);break;case global.KEY_CLASS_TREE:global.showTree=!global.showTree}if(global.canSkill)for(let e=0;e<1+8*global.statMaxing;e++)switch(a.keyCode){case global.KEY_UPGRADE_ATK:this.parent.socket.talk("x",0);break;case global.KEY_UPGRADE_HTL:this.parent.socket.talk("x",1);break;case global.KEY_UPGRADE_SPD:this.parent.socket.talk("x",2);break;case global.KEY_UPGRADE_STR:this.parent.socket.talk("x",3);break;case global.KEY_UPGRADE_PEN:this.parent.socket.talk("x",4);break;case global.KEY_UPGRADE_DAM:this.parent.socket.talk("x",5);break;case global.KEY_UPGRADE_RLD:this.parent.socket.talk("x",6);break;case global.KEY_UPGRADE_MOB:this.parent.socket.talk("x",7);break;case global.KEY_UPGRADE_RGN:this.parent.socket.talk("x",8);break;case global.KEY_UPGRADE_SHI:this.parent.socket.talk("x",9)}if(global.canUpgrade)switch(a.keyCode){case global.KEY_CHOOSE_1:this.parent.socket.talk("U",0);break;case global.KEY_CHOOSE_2:this.parent.socket.talk("U",1);break;case global.KEY_CHOOSE_3:this.parent.socket.talk("U",2);break;case global.KEY_CHOOSE_4:this.parent.socket.talk("U",3);break;case global.KEY_CHOOSE_5:this.parent.socket.talk("U",4);break;case global.KEY_CHOOSE_6:this.parent.socket.talk("U",5);break;case global.KEY_CHOOSE_7:this.parent.socket.talk("U",6);break;case global.KEY_CHOOSE_8:this.parent.socket.talk("U",7)}}}keyboardUp(e){switch(e.keyCode){case global.KEY_UP_ARROW:case global.KEY_UP:this.parent.socket.cmd.set(0,!1);break;case global.KEY_DOWN_ARROW:case global.KEY_DOWN:this.parent.socket.cmd.set(1,!1);break;case global.KEY_LEFT_ARROW:case global.KEY_LEFT:this.parent.socket.cmd.set(2,!1);break;case global.KEY_RIGHT_ARROW:case global.KEY_RIGHT:this.parent.socket.cmd.set(3,!1);break;case global.KEY_MOUSE_0:this.parent.socket.cmd.set(4,!1);break;case global.KEY_MOUSE_1:this.parent.socket.cmd.set(5,!1);break;case global.KEY_MOUSE_2:this.parent.socket.cmd.set(6,!1);break;case global.KEY_MAX_STAT:global.statMaxing=!1}}mouseDown(e){switch(e.button){case 0:var a={x:e.clientX*global.ratio,y:e.clientY*global.ratio},t=global.clickables.stat.check(a);-1!==t?this.parent.socket.talk("x",t):-1!==global.clickables.skipUpgrades.check(a)?global.clearUpgrades():-1!==(t=global.clickables.upgrade.check(a))?this.parent.socket.talk("U",t):this.parent.socket.cmd.set(4,!0);break;case 1:this.parent.socket.cmd.set(5,!0);break;case 2:this.parent.socket.cmd.set(6,!0)}}mouseUp(e){switch(e.button){case 0:this.parent.socket.cmd.set(4,!1);break;case 1:this.parent.socket.cmd.set(5,!1);break;case 2:this.parent.socket.cmd.set(6,!1)}}gameInput(e){this.parent.target.x=e.clientX*global.ratio-this.width/2,this.parent.target.y=e.clientY*global.ratio-this.height/2,global.target=this.parent.target,global.statHover=0===global.clickables.hover.check({x:e.clientX*global.ratio,y:e.clientY*global.ratio})}}export{Canvas};